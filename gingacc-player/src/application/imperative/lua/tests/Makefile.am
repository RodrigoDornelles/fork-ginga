# Makefile.am -- Template for generating Makefile via Automake.
#
# Copyright (C) 2006-2012 PUC-Rio/Laboratorio TeleMidia
#
# This program is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by the Free
# Software Foundation; either version 2 of the License, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
# for more details.
#
# You should have received a copy of the GNU General Public License along
# with this program; if not, write to the Free Software Foundation, Inc., 51
# Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.

TESTS=                             \
  test-event-register.xncl         \
  test-event-register-edit.xncl    \
  test-event-register-key.xncl     \
  test-event-register-ncl.xncl     \
  test-event-register-pointer.xncl \
  test-event-register-si.xncl      \
  test-event-register-sms.xncl     \
  test-event-register-tcp.xncl     \
  test-event-register-user.xncl    \
  test-event-unregister.xncl       \
  test-event-timer.xncl            \
  test-event-timer-cancel.xncl     \
  test-event-uptime.xncl           \
  test-property-attribution-0.ncl  \
  test-bad-lua-0.ncl               \
  test-bad-lua-1.ncl

XFAIL_TESTS=
TESTS_ENVIRONMENT= $(srcdir)/run.sh

EXTRA_DIST=    \
  connbase.ncl \
  exit.lua     \
  tests.lua

# Generate the NCL wrappers.
SUFFIXES=.lua .xncl
.lua.xncl:
	@xncl="$*.xncl"; TESTNAME="$*"; \
	echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" >$$xncl; \
	echo "<!-- Generated by Makefile.  DO NOT EDIT.  -->" >>$$xncl; \
	echo "<ncl id=\"$$TESTNAME\">" >>$$xncl; \
	echo "<head></head>" >>$$xncl; \
	echo "<body>" >>$$xncl; \
	echo "  <port id=\"start\" component=\"lua\"/>" >>$$xncl; \
	echo "  <media id=\"lua\" src=\"$$TESTNAME.lua\"/>" >>$$xncl; \
	echo "</body>" >>$$xncl; \
	echo "</ncl>" >>$$xncl;

clean-local:
	@for target in $(TESTS); do \
	  case $$target in \
	  *.xncl) rm -f $$target ;; \
	  *)      continue       ;; \
	  esac; \
	done

MAINTAINERCLEANFILES= Makefile.in
